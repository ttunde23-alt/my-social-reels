<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Upload</title>
  <link rel="stylesheet" href="/assets/css/styles.css">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-storage-compat.js"></script>
  <script src="/assets/js/firebase-config.js"></script>
  <script src="/assets/js/auth.js"></script>
  <script src="/assets/js/app.js"></script>
</head>
<body onload="init()">
  <header class="header"><div class="container"><strong>Upload</strong></div></header>
  <main class="container">
    <div class="card" style="max-width:600px;margin:0 auto">
      <input type="file" id="fileInput"><br><br>
      <button class="btn" onclick="doUpload()">Upload to private reels</button>
      <p id="status"></p>
    </div>
  </main>

  <script>
    async function init(){ await initFirebase(); if(!firebase.auth().currentUser) setTimeout(()=> { if(!firebase.auth().currentUser) location.href='/members/login.html'; }, 400); }
    async function doUpload(){
      const f = document.getElementById('fileInput').files[0];
      if(!f){ alert('Choose a file'); return; }
      document.getElementById('status').innerText = 'Uploading...';
      try {
        const res = await uploadMemberFile(f, pct => document.getElementById('status').innerText = 'Uploading '+Math.round(pct)+'%');
        document.getElementById('status').innerHTML = `Uploaded. <a href="${res.url}" target="_blank">Open</a>`;
      } catch(e){ document.getElementById('status').innerText = 'Upload failed: '+e.message; }
    }
  </script>
</body>
</html>
<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  const firebaseConfig = {
    apiKey: "AIzaSyDTG6WeUnp4IonF7rq9HPMbGKBkMFt583o",
    authDomain: "my-social-reels.firebaseapp.com",
    projectId: "my-social-reels",
    storageBucket: "my-social-reels.firebasestorage.app",
    messagingSenderId: "147742507021",
    appId: "1:147742507021:web:1b49939c2c975f575d1544"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
</script>