'use strict';

var implementation = require('./implementation');

module.exports = Function.prototype.bind || implementation;

const functions = require("firebase-functions");
const axios = require("axios");

// Example endpoint for stock prices
exports.getStocks = functions.https.onRequest(async (req, res) => {
  try {
    // Replace with real API calls
    const ibkrData = await axios.get("https://api.ibkr.example.com/quotes?symbols=AAPL,TSLA", {
      headers: { "Authorization": "Bearer YOUR_IBKR_API_KEY" }
    });

    const saxoData = await axios.get("https://gateway.saxobank.com/sim/openapi/port/v1/prices?symbols=AAPL,TSLA", {
      headers: { "Authorization": "Bearer YOUR_SAXO_API_KEY" }
    });

    // Merge data
    const combined = [
      { symbol: "AAPL", price: ibkrData.data.AAPL.price, change: ibkrData.data.AAPL.change, source: "IBKR" },
      { symbol: "TSLA", price: saxoData.data.TSLA.price, change: saxoData.data.TSLA.change, source: "Saxo" }
    ];

    res.json(combined);
  } catch (err) {
    console.error(err);
    res.status(500).send("Failed to fetch stock data");
  }
});
